"use strict";(self.webpackChunk_13_candles_cms=self.webpackChunk_13_candles_cms||[]).push([[5895],{3101:(mt,B,t)=>{t.d(B,{G4:()=>lt,Te:()=>Et});var e=t(92686),L=t(67294),r=t(20297),H=t(57557),h=t.n(H),A=t(96854);const $=(f,m)=>({...f,fieldsToPick:m});var V=t(18172),z=t(78718),Q=t.n(z),R=t(36968),x=t.n(R),D=t(98601),N=t.n(D);const ot={fieldsToPick:[],formErrors:{},initialData:{},isLoading:!0,modifiedData:{},showHeaderButtonLoader:!1,showHeaderLoader:!0},a=(f,m)=>(0,V.ZP)(f,u=>{switch(m.type){case"GET_DATA_SUCCEEDED":{u.isLoading=!1,u.showHeaderLoader=!1,u.initialData=Q()(m.data,f.fieldsToPick),u.modifiedData=Q()(m.data,f.fieldsToPick);break}case"ON_CANCEL":{u.modifiedData=f.initialData,u.formErrors={};break}case"ON_CHANGE":{m.inputType==="password"&&!m.value?N()(u.modifiedData,m.keys.split(".")):m.keys.includes("username")&&!m.value?x()(u.modifiedData,m.keys.split("."),null):x()(u.modifiedData,m.keys.split("."),m.value);break}case"ON_SUBMIT":{u.showHeaderButtonLoader=!0;break}case"ON_SUBMIT_SUCCEEDED":{u.initialData=Q()(m.data,f.fieldsToPick),u.modifiedData=Q()(m.data,f.fieldsToPick),u.showHeaderButtonLoader=!1;break}case"SET_ERRORS":{u.formErrors=m.errors,u.showHeaderButtonLoader=!1;break}default:return u}}),lt=(f,m,u,w)=>{const[{formErrors:at,initialData:_,isLoading:P,modifiedData:F,showHeaderButtonLoader:X,showHeaderLoader:tt},U]=(0,L.useReducer)(a,ot,()=>$(ot,w)),C=(0,r.lm)(),{lockApp:b,unlockApp:pt}=(0,r.o1)(),{get:dt,put:st}=(0,r.kY)();return(0,L.useEffect)(()=>{f&&(async()=>{try{const{data:{data:T}}=await dt(f);U({type:"GET_DATA_SUCCEEDED",data:T,fieldsToPick:w})}catch(T){console.error(T.response),C({type:"warning",message:{id:"notification.error"}})}})()},[f]),[{formErrors:at,initialData:_,isLoading:P,modifiedData:F,showHeaderButtonLoader:X,showHeaderLoader:tt},U,{handleCancel:()=>{U({type:"ON_CANCEL"})},handleChange:({target:{name:W,value:T,type:y}})=>{U({type:"ON_CHANGE",inputType:y,keys:W,value:T})},handleSubmit:async W=>{W.preventDefault();const T=await(0,A.R6)(F,m);if(U({type:"SET_ERRORS",errors:T||{}}),!T)try{b(),U({type:"ON_SUBMIT"});const y=h()(F,["confirmPassword","registrationToken"]);y.roles&&(y.roles=y.roles.map(et=>et.id)),y.ssoLockedRoles&&(y.ssoLockedRoles=[...new Set(y.ssoLockedRoles)]);const{data:{data:I}}=await st(f,y);u(I),U({type:"ON_SUBMIT_SUCCEEDED",data:I}),C({type:"success",message:{id:"notification.success.saved"}})}catch(y){const I=y?.response?.payload??{data:{}};I?.data&&typeof I.data=="string"?C({type:"warning",message:I.data}):C({type:"warning",message:I.message});const et=(0,A.Iz)(I);U({type:"SET_ERRORS",errors:et})}finally{pt()}},setField:(W,T)=>{U({type:"ON_CHANGE",keys:W,value:T})}}]};var ut=t(86706),gt=t(36364),Lt=t(48232);const yt={global:[{intlLabel:{id:"Settings.application.title",defaultMessage:"Overview"},to:"/settings/application-infos",id:"000-application-infos",permissions:[]},{intlLabel:{id:"Settings.webhooks.title",defaultMessage:"Webhooks"},to:"/settings/webhooks",id:"webhooks"},{intlLabel:{id:"Settings.apiTokens.title",defaultMessage:"API Tokens"},to:"/settings/api-tokens?sort=name:ASC",id:"api-tokens"},{intlLabel:{id:"Settings.transferTokens.title",defaultMessage:"Transfer Tokens"},to:"/settings/transfer-tokens?sort=name:ASC",id:"transfer-tokens"}],admin:[{intlLabel:{id:"global.roles",defaultMessage:"Roles"},to:"/settings/roles",id:"roles"},{intlLabel:{id:"global.users"},to:"/settings/users?pageSize=10&page=1&sort=firstname",id:"users"}]},Y=f=>f.map(m=>{const u=m.links.map(w=>({...w,isDisplayed:!1}));return{...m,links:u}});var Mt=t(89734),J=t.n(Mt);const ht=f=>J()(f,m=>m.id),Et=()=>{const[{isLoading:f,menu:m},u]=(0,L.useState)({isLoading:!0,menu:[]}),{allPermissions:w}=(0,r.vn)(),{shouldUpdateStrapi:at}=(0,r.L7)(),{settings:_}=(0,r.j1)(),P=(0,ut.v9)(gt._),{global:F,admin:X}=(0,Lt.c)(yt,async()=>(await t.e(3683).then(t.bind(t,53683))).LINKS_EE,{combine(C,b){return{admin:[...b.admin,...C.admin],global:[...C.global,...b.global]}},defaultValue:{admin:[],global:[]}}),tt=(0,L.useCallback)(C=>{if(!C.id)throw new Error("The settings menu item must have an id attribute.");return{...C,permissions:P.settings?.[C.id]?.main}},[P.settings]);(0,L.useEffect)(()=>{const C=async()=>{const vt=await(ct=>Promise.all(ct.reduce((k,it,W)=>{const T=y=>y.map(async(I,et)=>({hasPermission:await(0,r.qX)(w,I.permissions),sectionIndex:W,linkIndex:et}));return[...k,...T(it.links)]},[])))(dt);u(ct=>({...ct,isLoading:!1,menu:dt.map((k,it)=>({...k,links:k.links.map((W,T)=>{const y=vt.find(I=>I.sectionIndex===it&&I.linkIndex===T);return{...W,isDisplayed:Boolean(y.hasPermission)}})}))}))},{global:b,...pt}=_,dt=Y([{..._.global,links:ht([..._.global.links,...F.map(tt)]).map(st=>({...st,hasNotification:st.id==="000-application-infos"&&at}))},{id:"permissions",intlLabel:{id:"Settings.permissions",defaultMessage:"Administration Panel"},links:X.map(tt)},...Object.values(pt)]);C()},[X,F,w,_,at,tt]);const U=C=>({...C,links:C.links.filter(b=>b.isDisplayed)});return{isLoading:f,menu:m.map(U)}}},92686:(mt,B,t)=>{t.d(B,{G:()=>H});var e=t(67294),L=t(20297),r=t(88767);function H(){const{get:h}=(0,L.kY)(),{formatAPIError:A}=(0,L.So)(),Z=(0,L.lm)(),$=(0,r.useQueries)(["components","content-types"].map(D=>({queryKey:["content-manager",D],async queryFn(){const{data:{data:N}}=await h(`/content-manager/${D}`);return N},onError(N){Z({type:"warning",message:A(N)})}}))),[V,z]=$,Q=V.isLoading||z.isLoading,R=e.useMemo(()=>(z?.data??[]).filter(D=>D.kind==="collectionType"&&D.isDisplayed),[z?.data]),x=e.useMemo(()=>(z?.data??[]).filter(D=>D.kind!=="collectionType"&&D.isDisplayed),[z?.data]);return{isLoading:Q,components:e.useMemo(()=>V?.data??[],[V?.data]),collectionTypes:R,singleTypes:x}}},39223:(mt,B,t)=>{t.r(B),t.d(B,{SettingsPage:()=>Me});var e=t(67294),L=t(67242),r=t(20297),H=t(64593),h=t(86896),A=t(16550),Z=t(3101),$=t(48232),V=t(95187),z=t(14155),Q=t(66712),R=t(5330),x=t(61499),D=t(21660),N=t(36636),ot=t(45697),a=t.n(ot),ft=t(73727);const lt=({menu:o})=>{const{formatMessage:n}=(0,h.Z)(),{trackUsage:i}=(0,r.rS)(),{pathname:s}=(0,A.TH)(),p=o.filter(d=>!d.links.every(l=>l.isDisplayed===!1)).map(d=>({...d,title:d.intlLabel,links:d.links.map(l=>({...l,title:l.intlLabel,name:l.id}))})),E=n({id:"global.settings",defaultMessage:"Settings"}),g=(d=null)=>{i("willNavigate",{from:s,to:d})};return e.createElement(Q.m,{ariaLabel:E},e.createElement(R.p,{label:E}),e.createElement(x.Z,null,p.map(d=>e.createElement(D.D,{key:d.id,label:n(d.intlLabel)},d.links.map(l=>e.createElement(N.E,{as:ft.OL,withBullet:l.hasNotification,to:l.to,onClick:()=>g(l.to),key:l.id},n(l.intlLabel)))))))};lt.propTypes={menu:a().array.isRequired};const ut=lt,gt=[{async Component(){return await t.e(3455).then(t.bind(t,7513))},to:"/settings/roles",exact:!0},{async Component(){return await Promise.all([t.e(9634),t.e(2544)]).then(t.bind(t,25545))},to:"/settings/roles/duplicate/:id",exact:!0},{async Component(){return await Promise.all([t.e(9634),t.e(2544)]).then(t.bind(t,25545))},to:"/settings/roles/new",exact:!0},{async Component(){return await Promise.all([t.e(9634),t.e(2544)]).then(t.bind(t,63727))},to:"/settings/roles/:id",exact:!0},{async Component(){return await t.e(5199).then(t.bind(t,87901))},to:"/settings/users",exact:!0},{async Component(){return await t.e(4263).then(t.bind(t,93552))},to:"/settings/users/:id",exact:!0},{async Component(){return await t.e(5162).then(t.bind(t,71589))},to:"/settings/webhooks/create",exact:!0},{async Component(){return await t.e(5162).then(t.bind(t,10372))},to:"/settings/webhooks/:id",exact:!0},{async Component(){return await t.e(4121).then(t.bind(t,21162))},to:"/settings/webhooks",exact:!0},{async Component(){return await t.e(8056).then(t.bind(t,71362))},to:"/settings/api-tokens",exact:!0},{async Component(){return await Promise.all([t.e(9634),t.e(242),t.e(2458),t.e(4299)]).then(t.bind(t,1880))},to:"/settings/api-tokens/create",exact:!0},{async Component(){return await Promise.all([t.e(9634),t.e(242),t.e(2458),t.e(92)]).then(t.bind(t,50955))},to:"/settings/api-tokens/:id",exact:!0},{async Component(){return await Promise.all([t.e(9634),t.e(242),t.e(3467),t.e(4816)]).then(t.bind(t,81524))},to:"/settings/transfer-tokens/create",exact:!0},{async Component(){return await t.e(9600).then(t.bind(t,68446))},to:"/settings/transfer-tokens",exact:!0},{async Component(){return await Promise.all([t.e(9634),t.e(242),t.e(3467),t.e(2492)]).then(t.bind(t,63252))},to:"/settings/transfer-tokens/:id",exact:!0}];var Lt=t(85841),yt=t(70257),zt=t(57497),Y=t(39219),Mt=t(24),J=t(61697),O=t(50922),ht=t(54033),rt=t(89899),Et=t(9339),f=t(42195),m=t(59019),u=t(88767),w=t(86706),at=t(83171),_=t(36364),P=t(97554);const F=750,X=100,tt=["image/jpeg","image/png","image/svg+xml"];var U=t(85986),C=t(77143),b=t(61829),pt=t(21025),dt=t(26911),st=t(4378),vt=t(36956),ct=t(67366),k=t(18172);const it={localImage:void 0},T=(o=it,n)=>(0,k.ZP)(o,i=>{switch(n.type){case"SET_LOCAL_IMAGE":{i.localImage=n.value;break}default:return i}}),y=({onChangeLogo:o,customLogo:n,goTo:i,Component:s,modalTitle:c,next:p,prev:E,currentStep:g})=>{const[{localImage:d},l]=(0,e.useReducer)(T,it),{formatMessage:S}=(0,h.Z)(),v=G=>{l({type:"SET_LOCAL_IMAGE",value:G})},j=()=>{i(null)};return g?e.createElement(vt.P,{labelledBy:"modal",onClose:j},e.createElement(ct.x,null,e.createElement(O.Z,{fontWeight:"bold",as:"h2",id:"modal"},S(c))),e.createElement(s,{setLocalImage:v,goTo:i,next:p,prev:E,onClose:j,asset:d||n,onChangeLogo:o})):null};y.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},y.propTypes={Component:a().elementType,currentStep:a().string,customLogo:a().shape({name:a().string,url:a().string,width:a().number,height:a().number,ext:a().string}),goTo:a().func.isRequired,modalTitle:a().shape({id:a().string,defaultMessage:a().string}),next:a().string,onChangeLogo:a().func.isRequired,prev:a().string};const I=y,et={currentStep:void 0},Wt=(o=et,n)=>(0,k.ZP)(o,i=>{switch(n.type){case"GO_TO":{i.currentStep=n.to;break}default:return i}});var Kt=t(67765),Ct=t(63575),$t=t(7223),St=t(65454),Vt=t(23146),Qt=t(54045),Yt=t(502),Jt=t(2126),Tt=t(289),Xt=t(58106),bt=t(88972);const wt={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},Ft={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},kt=o=>new Promise(n=>{const i=new FileReader;i.onload=()=>{const s=new Image;s.onload=function(){n({width:s.width,height:s.height})},s.src=i.result},i.readAsDataURL(o)}),qt=(o,n)=>({ext:o.name.split(".").pop(),size:o.size/1e3,name:o.name,url:URL.createObjectURL(o),rawFile:o,width:n.width,height:n.height}),Ut=async o=>{let n;if(!tt.includes(o.type))throw n=new Error("File format"),n.displayMessage=wt,n;const s=await kt(o);if(!(s.width<=F&&s.height<=F))throw n=new Error("File sizing"),n.displayMessage=Ft,n;const p=qt(o,s);if(!(p.size<=X))throw n=new Error("File sizing"),n.displayMessage=Ft,n;return p},_t=(0,bt.default)(Vt._)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,Rt=({setLocalImage:o,goTo:n,next:i,onClose:s})=>{const{formatMessage:c}=(0,h.Z)(),[p,E]=(0,e.useState)(!1),[g,d]=(0,e.useState)(void 0),l=(0,e.useRef)(null),S=()=>E(!0),v=()=>E(!1),j=q=>{q.preventDefault(),l.current.click()},G=async()=>{v();const q=l.current.files[0];if(q)try{const nt=await Ut(q);o(nt),n(i)}catch(nt){if(nt.displayMessage)d(c(nt.displayMessage,{size:X,dimension:F})),l.current.focus();else throw nt}},K=()=>p?"primary500":g?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(P.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(Qt.g,{name:"logo-upload",error:g},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(J.k,{direction:"column",alignItems:"stretch",gap:2},e.createElement(J.k,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:p?"primary100":"neutral100",borderColor:K(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:S,onDragLeave:v},e.createElement(Yt.J,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:Xt.Z,"aria-hidden":!0}),e.createElement(P.x,{paddingTop:3,paddingBottom:5},e.createElement(O.Z,{variant:"delta",as:"span"},c({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(_t,{accept:tt,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:G,ref:l,id:"logo-upload"}),e.createElement(Y.z,{type:"button",onClick:j},c({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(P.x,{paddingTop:6},e.createElement(O.Z,{variant:"pi",textColor:"neutral600"},c({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:X,dimension:F})))),e.createElement(Jt.c,null)))))),e.createElement(Tt.m,{startActions:e.createElement(Y.z,{onClick:s,variant:"tertiary"},c({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};Rt.defaultProps={next:null},Rt.propTypes={goTo:a().func.isRequired,next:a().string,onClose:a().func.isRequired,setLocalImage:a().func.isRequired};const te=Rt;var ee=t(22790);const ne=async o=>{try{const{get:n}=(0,r.tg)(),i=await n(o,{responseType:"blob",timeout:8e3});return new File([i.data],i.config.url,{type:i.headers["content-type"]})}catch(n){throw n.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},n}},xt=({goTo:o,next:n,onClose:i,setLocalImage:s})=>{const{formatMessage:c}=(0,h.Z)(),[p,E]=(0,e.useState)(""),[g,d]=(0,e.useState)(null),l=v=>{E(v.target.value)},S=async()=>{try{const v=await ne(p),j=await Ut(v);s(j),o(n)}catch(v){if(v.displayMessage)d(c(v.displayMessage,{size:X,dimension:F}));else throw v}};return e.createElement("form",{onSubmit:v=>{v.preventDefault(),S()}},e.createElement(P.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(ee.o,{label:c({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:g,onChange:l,value:p,name:"logo-url"})),e.createElement(Tt.m,{startActions:e.createElement(Y.z,{onClick:i,variant:"tertiary"},c({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(Y.z,{type:"submit"},c({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};xt.defaultProps={next:null},xt.propTypes={goTo:a().func.isRequired,next:a().string,onClose:a().func.isRequired,setLocalImage:a().func.isRequired};const oe=xt,Dt=({setLocalImage:o,goTo:n,next:i,onClose:s})=>{const{formatMessage:c}=(0,h.Z)();return e.createElement(Kt.v,{label:c({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(P.x,{paddingLeft:8,paddingRight:8},e.createElement(Ct.m,null,e.createElement(Ct.O,null,c({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(Ct.O,null,c({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement($t.i,null)),e.createElement(St.n,null,e.createElement(St.x,null,e.createElement(te,{onClose:s,setLocalImage:o,goTo:n,next:i})),e.createElement(St.x,null,e.createElement(oe,{onClose:s,setLocalImage:o,goTo:n,next:i}))))};Dt.defaultProps={next:null},Dt.propTypes={goTo:a().func.isRequired,next:a().string,onClose:a().func.isRequired,setLocalImage:a().func.isRequired};const ae=Dt;var se=t(57641),ie=t(49445),le=t(67973),re=t(70132),de=t(42592),Bt=t(24085),ce=t(79252);const Zt=({asset:o})=>{const{formatMessage:n}=(0,h.Z)();return e.createElement(se.Z,null,e.createElement(ie.O,null,e.createElement(le.H,{size:"S",src:o.url})),e.createElement(re.e,null,e.createElement(de.a,null,e.createElement(Bt.l,null,o.name),e.createElement(Bt._,null,`${o.ext.toUpperCase()} - ${o.width}\u2715${o.height}`)),e.createElement(ce.E,null,n({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};Zt.propTypes={asset:a().shape({name:a().string,url:a().string,width:a().number,height:a().number,ext:a().string}).isRequired};const me=Zt,Ot=({onClose:o,asset:n,prev:i,next:s,goTo:c,setLocalImage:p,onChangeLogo:E})=>{const{formatMessage:g}=(0,h.Z)(),d=()=>{p(void 0),c(i)},l=()=>{E(n),c(s)};return e.createElement(e.Fragment,null,e.createElement(P.x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(J.k,{justifyContent:"space-between",paddingBottom:6},e.createElement(J.k,{direction:"column",alignItems:"flex-start"},e.createElement(O.Z,{variant:"pi",fontWeight:"bold"},g({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement(O.Z,{variant:"pi",textColor:"neutral500"},g({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(Y.z,{onClick:d,variant:"secondary"},g({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(P.x,{maxWidth:(0,r.Q1)(180)},n.url?e.createElement(me,{asset:n}):null)),e.createElement(Tt.m,{startActions:e.createElement(Y.z,{onClick:o,variant:"tertiary"},g({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(Y.z,{onClick:l},g({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};Ot.defaultProps={next:null,prev:null},Ot.propTypes={goTo:a().func.isRequired,asset:a().shape({name:a().string,url:a().string,width:a().number,height:a().number,ext:a().string}).isRequired,next:a().string,onClose:a().func.isRequired,onChangeLogo:a().func.isRequired,prev:a().string,setLocalImage:a().func.isRequired};const ue={upload:{Component:ae,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:Ot,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},It=({canUpdate:o,customLogo:n,defaultLogo:i,hint:s,label:c,onChangeLogo:p,onResetLogo:E})=>{const[{currentStep:g},d]=(0,e.useReducer)(Wt,et),{Component:l,next:S,prev:v,modalTitle:j}=ue[g]||{},{formatMessage:G}=(0,h.Z)(),K=q=>{d({type:"GO_TO",to:q})};return e.createElement(e.Fragment,null,e.createElement(U.F,{label:c,selectedSlide:0,hint:s,previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:n?.name||"logo.png",actions:e.createElement(C.b,null,e.createElement(b.h,{disabled:!o,onClick:()=>K(n?"pending":"upload"),label:G({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(dt.Z,null)}),n&&e.createElement(b.h,{disabled:!o,onClick:E,label:G({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(st.Z,null)}))},e.createElement(pt.q,{label:G({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(P.x,{maxHeight:"40%",maxWidth:"40%",as:"img",src:n?.url||i,alt:G({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(I,{Component:l,currentStep:g,onChangeLogo:p,customLogo:n,goTo:K,next:S,prev:v,modalTitle:j}))};It.defaultProps={canUpdate:!1,customLogo:null,hint:null},It.propTypes={canUpdate:a().bool,customLogo:a().shape({url:a().string,name:a().string}),label:a().string.isRequired,hint:a().string,defaultLogo:a().string.isRequired,onChangeLogo:a().func.isRequired,onResetLogo:a().func.isRequired};const Nt=It;var ge=t(82492),pe=t.n(ge);const fe=(o,n)=>pe()(o,{menuLogo:{display:n.menuLogo},authLogo:{display:n.authLogo}}),At={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}},authLogo:{display:null,submit:{rawFile:null,isReset:!1}}},he=(o=At,n)=>(0,k.ZP)(o,i=>{switch(n.type){case"SET_CUSTOM_MENU_LOGO":{i.menuLogo.display=n.value,i.menuLogo.submit.rawFile=n.value.rawFile;break}case"SET_CUSTOM_AUTH_LOGO":{i.authLogo.display=n.value,i.authLogo.submit.rawFile=n.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{i.menuLogo.display=null,i.menuLogo.submit={rawFile:null,isReset:!0};break}case"RESET_CUSTOM_AUTH_LOGO":{i.authLogo.display=null,i.authLogo.submit={rawFile:null,isReset:!0};break}default:return i}}),Pt=(0,e.forwardRef)(({canUpdate:o,projectSettingsStored:n},i)=>{const{formatMessage:s}=(0,h.Z)(),{trackUsage:c}=(0,r.rS)(),{logos:{menu:p,auth:E}}=(0,at.m)(),[{menuLogo:g,authLogo:d},l]=(0,e.useReducer)(he,At,()=>fe(At,n)),S=K=>{l({type:"SET_CUSTOM_MENU_LOGO",value:K})},v=()=>{c("didClickResetLogo",{logo:"menu"}),l({type:"RESET_CUSTOM_MENU_LOGO"})},j=K=>{l({type:"SET_CUSTOM_AUTH_LOGO",value:K})},G=()=>{c("didClickResetLogo",{logo:"auth"}),l({type:"RESET_CUSTOM_AUTH_LOGO"})};return(0,e.useImperativeHandle)(i,()=>({getValues:()=>({menuLogo:g.submit,authLogo:d.submit})})),e.createElement(P.x,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(O.Z,{variant:"delta",as:"h3"},s({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement(O.Z,{variant:"pi",textColor:"neutral600"},s({id:"Settings.application.customization.size-details",defaultMessage:"Max dimension: {dimension}\xD7{dimension}, Max file size: {size}KB"},{dimension:F,size:X})),e.createElement(ht.r,{paddingTop:4,gap:4},e.createElement(rt.P,{col:6,s:12},e.createElement(Nt,{canUpdate:o,customLogo:g.display,defaultLogo:p.default,hint:s({id:"Settings.application.customization.menu-logo.carousel-hint",defaultMessage:"Replace the logo in the main navigation"}),label:s({id:"Settings.application.customization.carousel.menu-logo.title",defaultMessage:"Menu logo"}),onChangeLogo:S,onResetLogo:v})),e.createElement(rt.P,{col:6,s:12},e.createElement(Nt,{canUpdate:o,customLogo:d.display,defaultLogo:E.default,hint:s({id:"Settings.application.customization.auth-logo.carousel-hint",defaultMessage:"Replace the logo in the authentication pages"}),label:s({id:"Settings.application.customization.carousel.auth-logo.title",defaultMessage:"Auth logo"}),onChangeLogo:j,onResetLogo:G}))))});Pt.defaultProps={canUpdate:!1,projectSettingsStored:null},Pt.propTypes={canUpdate:a().bool,projectSettingsStored:a().shape({menuLogo:a().shape({url:a().string,name:a().string})})};const Ee=Pt,ve=o=>{const n=new FormData;return Object.entries(o).forEach(([i,s])=>{s&&s.rawFile instanceof File&&n.append(i,s.rawFile),s&&s.isReset&&n.append(i,null)}),n},Le=()=>null,ye=()=>{const o=e.useRef(),n=(0,r.lm)(),{trackUsage:i}=(0,r.rS)(),{formatMessage:s}=(0,h.Z)(),{get:c,post:p}=(0,r.kY)(),{updateProjectSettings:E}=(0,at.m)(),g=(0,w.v9)(_._),{formatAPIError:d}=(0,r.So)(),{communityEdition:l,latestStrapiReleaseTag:S,nodeVersion:v,shouldUpdateStrapi:j,strapiVersion:G}=(0,r.L7)(),K=(0,$.c)(Le,async()=>(await t.e(5013).then(t.bind(t,65013))).AdminSeatInfoEE),{allowedActions:{canRead:q,canUpdate:nt}}=(0,r.ss)(g.settings["project-settings"]);(0,r.go)();const{data:jt,isLoading:Ce}=(0,u.useQuery)(["project-settings"],async()=>{const{data:M}=await c("/admin/project-settings");return M},{cacheTime:0,enabled:q,select(M){return{...M,authLogo:M.authLogo?{...M.authLogo,url:(0,r.CR)(M.authLogo.url)}:M.authLogo,menuLogo:M.menuLogo?{...M.menuLogo,url:(0,r.CR)(M.menuLogo.url)}:M.menuLogo}}}),Se=(0,u.useMutation)(M=>p("/admin/project-settings",M,{headers:{"Content-Type":"multipart/form-data"}}),{onError(M){n({type:"warning",message:d(M)})},async onSuccess(M){const{menuLogo:Gt,authLogo:Ht}=M;E({menuLogo:Gt?.url,authLogo:Ht?.url}),Gt?.rawFile&&i("didChangeLogo",{logo:"menu"}),Ht?.rawFile&&i("didChangeLogo",{logo:"auth"}),n({type:"success",message:s({id:"app",defaultMessage:"Saved"})})}}),Te=M=>{M.preventDefault(),Se.mutate(ve(o.current.getValues()))};return K?e.createElement(L.A,null,e.createElement(r.SL,{name:"Application"}),e.createElement(Lt.o,null,Ce?e.createElement(yt.a,null,s({id:"Settings.application.isLoading",defaultMessage:"Loading"})):e.createElement("form",{onSubmit:Te},e.createElement(zt.T,{title:s({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:s({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:nt&&e.createElement(Y.z,{type:"submit",startIcon:e.createElement(f.Z,null)},s({id:"global.save",defaultMessage:"Save"}))}),e.createElement(Mt.D,null,e.createElement(J.k,{direction:"column",alignItems:"stretch",gap:6},e.createElement(J.k,{direction:"column",alignItems:"stretch",gap:4,hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(O.Z,{variant:"delta",as:"h3"},s({id:"global.details",defaultMessage:"Details"})),e.createElement(ht.r,{gap:5,as:"dl"},e.createElement(rt.P,{col:6,s:12},e.createElement(O.Z,{variant:"sigma",textColor:"neutral600",as:"dt"},s({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement(J.k,{gap:3,direction:"column",alignItems:"start",as:"dd"},e.createElement(O.Z,null,"v",G),j&&e.createElement(Et.r,{href:`https://github.com/strapi/strapi/releases/tag/${S}`,isExternal:!0,endIcon:e.createElement(m.Z,null)},s({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"})))),e.createElement(rt.P,{col:6,s:12},e.createElement(O.Z,{variant:"sigma",textColor:"neutral600",as:"dt"},s({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement(J.k,{gap:3,direction:"column",alignItems:"start",as:"dd"},e.createElement(O.Z,null,s({id:"Settings.application.ee-or-ce",defaultMessage:"{communityEdition, select, true {Community Edition} other {Enterprise Edition}}"},{communityEdition:l})),e.createElement(Et.r,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(m.Z,null)},s({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(rt.P,{col:6,s:12},e.createElement(O.Z,{variant:"sigma",textColor:"neutral600",as:"dt"},s({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement(O.Z,{as:"dd"},v)),e.createElement(K,null))),q&&jt&&e.createElement(Ee,{canUpdate:nt,ref:o,projectSettingsStored:jt})))))):null};function Me(){const{settingId:o}=(0,A.UO)(),{settings:n}=(0,r.j1)(),{formatMessage:i}=(0,h.Z)(),{isLoading:s,menu:c}=(0,Z.Te)(),p=(0,$.c)(gt,async()=>(await t.e(3996).then(t.bind(t,51470))).ROUTES_EE,{combine(d,l){return[...d,...l]},defaultValue:[]}),E=e.useMemo(()=>(0,z.Z)(p.map(({to:d,Component:l,exact:S})=>(0,V.Z)(l,d,S))),[p]),g=Object.values(n).flatMap(d=>{const{links:l}=d;return l.map(S=>(0,V.Z)(S.Component,S.to,S.exact||!1))});return s?e.createElement(r.dO,null):o?e.createElement(L.A,{sideNav:e.createElement(ut,{menu:c})},e.createElement(H.q,{title:i({id:"global.settings",defaultMessage:"Settings"})}),e.createElement(A.rs,null,e.createElement(A.AW,{path:"/settings/application-infos",component:ye,exact:!0}),E,g)):e.createElement(A.l_,{to:"/settings/application-infos"})}},67242:(mt,B,t)=>{t.d(B,{A:()=>A});var e=t(85893),L=t(88972),r=t(97554);const H=(0,L.default)(r.x)`
  display: grid;
  grid-template-columns: ${({hasSideNav:Z})=>Z?"auto 1fr":"1fr"};
`,h=(0,L.default)(r.x)`
  overflow-x: hidden;
`,A=({sideNav:Z,children:$})=>(0,e.jsxs)(H,{hasSideNav:Boolean(Z),children:[Z,(0,e.jsx)(h,{paddingBottom:10,children:$})]})},9339:(mt,B,t)=>{t.d(B,{r:()=>Q});var e=t(85893),L=t(67294),r=t(59019),H=t(73727),h=t(88972),A=t(2527),Z=t(50922),$=t(97554);const V=h.default.a`
  display: inline-flex;
  align-items: center;
  text-decoration: none;
  pointer-events: ${({disabled:R})=>R?"none":void 0};
  color: ${({disabled:R,theme:x})=>R?x.colors.neutral600:x.colors.primary600};

  svg path {
    transition: fill 150ms ease-out;
    fill: currentColor;
  }

  svg {
    font-size: ${10/16}rem;
  }

  ${Z.Z} {
    transition: color 150ms ease-out;
    color: currentColor;
  }

  &:hover {
    color: ${({theme:R})=>R.colors.primary500};
  }

  &:active {
    color: ${({theme:R})=>R.colors.primary700};
  }

  ${A.BF};
`,z=(0,h.default)($.x)`
  display: flex;
`,Q=L.forwardRef(({children:R,href:x,to:D,disabled:N=!1,startIcon:ot,endIcon:a,...ft},lt)=>{const ut=x?"_blank":void 0,gt=x?"noreferrer noopener":void 0;return(0,e.jsxs)(V,{as:D&&!N?H.OL:"a",target:ut,rel:gt,to:N?void 0:D,href:N?"#":x,disabled:N,ref:lt,...ft,children:[ot&&(0,e.jsx)(z,{as:"span","aria-hidden":!0,paddingRight:2,children:ot}),(0,e.jsx)(Z.Z,{children:R}),a&&!x&&(0,e.jsx)(z,{as:"span","aria-hidden":!0,paddingLeft:2,children:a}),x&&(0,e.jsx)(z,{as:"span","aria-hidden":!0,paddingLeft:2,children:(0,e.jsx)(r.Z,{})})]})})},69004:(mt,B,t)=>{t.d(B,{Z:()=>r});var e=t(85893);const L=H=>(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1rem",height:"1rem",fill:"none",viewBox:"0 0 4 4",...H,children:(0,e.jsx)("rect",{width:4,height:4,fill:"#A5A5BA",rx:2})}),r=L}}]);
